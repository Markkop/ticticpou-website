import { db } from './index';
import { classes, actions, gameModes } from './schema';
import { v4 as uuidv4 } from 'uuid';

// Seed data for classes
const classesData = [
  // Base Classes
  {
    id: uuidv4(),
    name: 'Mago',
    description: 'Pode carregar e usar uma explos√£o m√°gica que ataca todos os jogadores ao mesmo tempo.',
    specialLoadSound: 'Abra',
    specialUseSound: 'Kadabra!',
    specialLoadGesture: 'Abre um livro figurativo com as m√£os',
    specialUseGesture: 'Faz como se uma explos√£o ca√≠sse dos c√©us',
    interactions: [
      'Se o Mago morrer durante o Kadabra, a explos√£o √© anulada',
      'Se dois Magos usarem explos√£o juntos, ambos morrem e ningu√©m mais √© atacado',
      'Kadabra ataca todos que n√£o estiverem defendendo'
    ],
    isBaseClass: true,
    category: 'base',
    maxBullets: 1,
  },
  {
    id: uuidv4(),
    name: 'Samurai',
    description: 'Classe defensiva que pode contra-atacar, refletindo qualquer ataque recebido.',
    specialLoadSound: 'Uh!',
    specialUseSound: 'Katchim!',
    specialLoadGesture: 'Coloca as duas m√£os do lado esquerdo da cintura como se segurasse uma espada',
    specialUseGesture: 'Puxa a espada da cintura e golpeia o ar',
    interactions: [
      'Reflete qualquer ataque recebido de volta ao atacante',
      'Se n√£o for atacado, o carregamento √© perdido',
      'Contra apunhalada do Assassino, ambos continuam vivos mas gastam carregamentos',
      'Pode refletir explos√µes do Mago, matando-o e anulando a explos√£o'
    ],
    isBaseClass: true,
    category: 'base',
    maxBullets: 1,
  },
  {
    id: uuidv4(),
    name: 'Padre',
    description: 'Classe "late-game" que pode ganhar uma vida extra ao rezar duas vezes com sucesso.',
    specialLoadSound: 'Ohh!',
    specialUseSound: null,
    specialLoadGesture: 'Junta as m√£os como se estivesse rezando',
    specialUseGesture: null,
    interactions: [
      'Precisa rezar duas vezes (n√£o precisam ser seguidas) para ganhar vida extra',
      'Pode ter no m√°ximo 1 vida extra',
      'Se perder a vida extra, pode rezar novamente para recuper√°-la',
      'Deve completar a segunda reza para ganhar a vida extra'
    ],
    isBaseClass: true,
    category: 'base',
    maxBullets: 1,
  },
  {
    id: uuidv4(),
    name: 'Cangaceiro',
    description: '√önica classe que pode ter duas balas, podendo atirar duas vezes ou em dois alvos simultaneamente.',
    specialLoadSound: null,
    specialUseSound: 'Pou! ou PouPou',
    specialLoadGesture: 'Recarregar normalmente duas vezes',
    specialUseGesture: 'Pode mirar em dois alvos com cada m√£o',
    interactions: [
      'Pode atirar em duas pessoas ao mesmo tempo ou em duas rodadas diferentes',
      'Para tiro duplo, mira com uma m√£o em cada alvo',
      'Se um dos alvos for Samurai refletindo, o Cangaceiro morre mas o outro alvo ainda recebe o tiro'
    ],
    isBaseClass: true,
    category: 'base',
    maxBullets: 2,
  },
  // Extra Classes
  {
    id: uuidv4(),
    name: 'Novi√ßo',
    description: 'Classe "caf√© com leite" para iniciantes, que se defende automaticamente ao atirar.',
    specialLoadSound: null,
    specialUseSound: 'Pou!',
    specialLoadGesture: null,
    specialUseGesture: 'Atira com uma m√£o e cruza a outra como escudo',
    interactions: [
      'Ao atirar, automaticamente se defende',
      'S√≥ pode ser usado uma ou duas vezes no m√°ximo',
      'Vulner√°vel apenas enquanto recarrega'
    ],
    isBaseClass: false,
    category: 'extra',
    maxBullets: 1,
  },
  {
    id: uuidv4(),
    name: 'Assassino',
    description: '√önica classe sem arma, possui apenas defesa e uma adaga para apunhalar jogadores ao lado.',
    specialLoadSound: 'Fshh',
    specialUseSound: 'Krek!',
    specialLoadGesture: 'Afia a adaga',
    specialUseGesture: 'Encosta a m√£o fechada no peito do alvo ao lado',
    interactions: [
      'N√£o pode usar Tic Tic ou Pou!',
      'Apunhalada s√≥ mata quem estiver defendendo',
      'Pode atacar apenas jogadores ao seu lado',
      'Quando um jogador ao lado morre, o pr√≥ximo vivo vira alvo',
      'Em 1x1, recupera a arma (Tic Tic e Pou)'
    ],
    isBaseClass: false,
    category: 'extra',
    maxBullets: 0,
  },
  {
    id: uuidv4(),
    name: 'Ladr√£o',
    description: 'Pode roubar carregamentos e balas de outros jogadores usando "Perdeu".',
    specialLoadSound: null,
    specialUseSound: 'Perdeu',
    specialLoadGesture: null,
    specialUseGesture: 'Faz como se estivesse pegando algo no ar',
    interactions: [
      'Rouba carregamentos de a√ß√µes especiais de outros jogadores',
      'Pode roubar balas durante Tic Tic',
      'Contra Padre, apenas cancela a reza sem roubar',
      'N√£o pode acumular a√ß√µes especiais',
      'N√£o pode usar "Perdeu" at√© usar a a√ß√£o roubada'
    ],
    isBaseClass: false,
    category: 'extra',
    maxBullets: 1,
  },
  {
    id: uuidv4(),
    name: 'Kabalista',
    description: 'Precisa fazer uma contagem regressiva de 5 turnos para ganhar o jogo.',
    specialLoadSound: null,
    specialUseSound: 'CINCO, QUATRO, TR√äS, DOIS, UM',
    specialLoadGesture: null,
    specialUseGesture: 'Mostra dedos correspondentes ao n√∫mero falado',
    interactions: [
      'N√£o possui Tic Tic nem Pou',
      'Deve contar de 5 at√© 1 para ganhar',
      'Vulner√°vel durante toda a contagem',
      'Se completar a contagem sem morrer, ganha automaticamente'
    ],
    isBaseClass: false,
    category: 'extra',
    maxBullets: 0,
  },
  {
    id: uuidv4(),
    name: 'Metamorfo',
    description: 'Conceito de classe que pode mudar para outras classes durante a partida usando "gosma".',
    specialLoadSound: null,
    specialUseSound: 'Gosma',
    specialLoadGesture: null,
    specialUseGesture: 'A√ß√£o direcional de gosma',
    interactions: [
      'N√£o possui arma, apenas defesa e gosma',
      'Se o alvo da gosma usar a√ß√£o especial, Metamorfo vira daquela classe',
      'Problemas com intera√ß√£o com Cangaceiro ainda sendo resolvidos'
    ],
    isBaseClass: false,
    category: 'extra',
    maxBullets: 0,
  },
  {
    id: uuidv4(),
    name: 'Pacificador',
    description: 'Pode cancelar todas as a√ß√µes da rodada e ganhar vida extra se salvar algu√©m.',
    specialLoadSound: 'Prepara',
    specialUseSound: 'Cancela!',
    specialLoadGesture: 'Cruza os bra√ßos para o alto formando um X',
    specialUseGesture: 'Descruza os bra√ßos como um juiz encerrando partida',
    interactions: [
      'Cancela todas as a√ß√µes da rodada',
      'Se salvar algu√©m da morte, ganha uma vida extra',
      'Se for atacado durante o cancelamento, sua a√ß√£o n√£o ativa',
      'N√£o pode cancelar duas vezes seguidas'
    ],
    isBaseClass: false,
    category: 'extra',
    maxBullets: 1,
  },
  // Team Classes
  {
    id: uuidv4(),
    name: 'Param√©dico',
    description: 'Exclusivo para modo Em Equipe - pode reviver aliados mortos usando desfibrilador.',
    specialLoadSound: 'Zzz',
    specialUseSound: 'Contato!',
    specialLoadGesture: 'Arrasta as m√£os de punhos fechados preparando desfibrilador',
    specialUseGesture: 'Encosta as m√£os de punhos fechados em aliado morto',
    interactions: [
      'S√≥ pode carregar se um aliado estiver morto',
      'Um jogador s√≥ pode reviver uma vez',
      'Exclusivo para modo Em Equipe'
    ],
    isBaseClass: false,
    category: 'team',
    maxBullets: 1,
  },
];

// Seed data for actions
const actionsData = [
  // Basic Actions
  {
    id: uuidv4(),
    name: 'Defender',
    description: 'A√ß√£o defensiva b√°sica que protege contra todos os ataques.',
    sound: null,
    gesture: 'Cruze os bra√ßos em X no peito',
    category: 'basic',
    className: null,
  },
  {
    id: uuidv4(),
    name: 'Recarregar',
    description: 'Carrega uma bala para poder atirar.',
    sound: 'Tic Tic',
    gesture: 'Levante ambas as m√£os como armas',
    category: 'basic',
    className: null,
  },
  {
    id: uuidv4(),
    name: 'Atirar',
    description: 'Ataca um jogador espec√≠fico gastando uma bala.',
    sound: 'Pou!',
    gesture: 'Aponte com as m√£os para o alvo',
    category: 'basic',
    className: null,
  },
  // Special Actions
  {
    id: uuidv4(),
    name: 'Abra',
    description: 'Carrega a explos√£o m√°gica do Mago.',
    sound: 'Abra',
    gesture: 'Abre um livro figurativo com as m√£os',
    category: 'special',
    className: 'Mago',
  },
  {
    id: uuidv4(),
    name: 'Kadabra',
    description: 'Explos√£o que ataca todos os jogadores simultaneamente.',
    sound: 'Kadabra!',
    gesture: 'Faz como se uma explos√£o ca√≠sse dos c√©us',
    category: 'special',
    className: 'Mago',
  },
  {
    id: uuidv4(),
    name: 'Uh',
    description: 'Carrega o contra-ataque do Samurai.',
    sound: 'Uh!',
    gesture: 'Coloca m√£os do lado da cintura como se segurasse espada',
    category: 'special',
    className: 'Samurai',
  },
  {
    id: uuidv4(),
    name: 'Katchim',
    description: 'Contra-ataque que reflete qualquer ataque recebido.',
    sound: 'Katchim!',
    gesture: 'Saca espada para o alto',
    category: 'special',
    className: 'Samurai',
  },
  {
    id: uuidv4(),
    name: 'Ohh (Rezar)',
    description: 'Reza para ganhar vida extra ap√≥s duas rezas bem-sucedidas.',
    sound: 'Ohh!',
    gesture: 'Junta as m√£os como se estivesse rezando',
    category: 'special',
    className: 'Padre',
  },
  {
    id: uuidv4(),
    name: 'Tiro Duplo',
    description: 'Atira em dois alvos simultaneamente ou em sequ√™ncia.',
    sound: 'Pou! ou PouPou',
    gesture: 'Mira com uma m√£o em cada alvo',
    category: 'special',
    className: 'Cangaceiro',
  },
  {
    id: uuidv4(),
    name: 'Fshh (Afiar)',
    description: 'Afia a adaga para poder apunhalar.',
    sound: 'Fshh',
    gesture: 'Movimentos de afiar a adaga',
    category: 'special',
    className: 'Assassino',
  },
  {
    id: uuidv4(),
    name: 'Krek (Apunhalar)',
    description: 'Apunhala um jogador ao lado - s√≥ mata se estiver defendendo.',
    sound: 'Krek!',
    gesture: 'Encosta m√£o fechada no peito do alvo ao lado',
    category: 'special',
    className: 'Assassino',
  },
  {
    id: uuidv4(),
    name: 'Perdeu',
    description: 'Rouba carregamentos e balas de outros jogadores.',
    sound: 'Perdeu',
    gesture: 'Faz como se pegasse algo no ar',
    category: 'special',
    className: 'Ladr√£o',
  },
  {
    id: uuidv4(),
    name: 'Contagem Regressiva',
    description: 'Conta de 5 at√© 1 para ganhar automaticamente.',
    sound: 'CINCO, QUATRO, TR√äS, DOIS, UM',
    gesture: 'Mostra dedos correspondentes ao n√∫mero',
    category: 'special',
    className: 'Kabalista',
  },
  {
    id: uuidv4(),
    name: 'Prepara',
    description: 'Carrega o cancelamento de a√ß√µes.',
    sound: 'Prepara',
    gesture: 'Cruza bra√ßos para o alto formando X',
    category: 'special',
    className: 'Pacificador',
  },
  {
    id: uuidv4(),
    name: 'Cancela',
    description: 'Cancela todas as a√ß√µes da rodada.',
    sound: 'Cancela!',
    gesture: 'Descruza bra√ßos como juiz encerrando partida',
    category: 'special',
    className: 'Pacificador',
  },
  {
    id: uuidv4(),
    name: 'Zzz (Preparar Desfibrilador)',
    description: 'Prepara desfibrilador para reviver aliado.',
    sound: 'Zzz',
    gesture: 'Arrasta m√£os de punhos fechados preparando desfibrilador',
    category: 'special',
    className: 'Param√©dico',
  },
  {
    id: uuidv4(),
    name: 'Contato',
    description: 'Revive um aliado morto.',
    sound: 'Contato!',
    gesture: 'Encosta m√£os de punhos fechados em aliado morto',
    category: 'special',
    className: 'Param√©dico',
  },
  // Finisher
  {
    id: uuidv4(),
    name: 'Finalizador',
    description: 'A√ß√£o especial para duelos 1x1 - quem usar 3 vezes ganha.',
    sound: 'N√£o tem som',
    gesture: 'Estalar dedos de ambas as m√£os (como Fam√≠lia Adams)',
    category: 'finisher',
    className: null,
  },
];

// Seed data for game modes
const gameModesData = [
  {
    id: uuidv4(),
    name: 'Cl√°ssico',
    description: 'O modo tradicional do Tic Tic Pou com Classes, usando as 4 classes base mais Novi√ßo.',
    rules: {
      minPlayersPerClass: 1,
      allowedClasses: ['Mago', 'Samurai', 'Padre', 'Cangaceiro', 'Novi√ßo'],
      winCondition: 'lastTwoPlayersWin',
      finalizerEnabled: true
    },
    minPlayers: 3,
    maxPlayers: 8,
  },
  {
    id: uuidv4(),
    name: 'Modo Campanha',
    description: 'Modo avan√ßado onde jogadores come√ßam sem classe e escolhem uma ao tirar a primeira vida.',
    rules: {
      startingLives: 2,
      startingClass: null,
      classSelectionOnKill: true,
      allowedClasses: ['Mago', 'Samurai', 'Padre', 'Cangaceiro', 'Assassino', 'Ladr√£o']
    },
    minPlayers: 4,
    maxPlayers: 10,
  },
  {
    id: uuidv4(),
    name: 'Em Equipe',
    description: 'Partidas de 2x2, 3x3, 4x4 com fogo amigo desabilitado e classes de suporte.',
    rules: {
      teamMode: true,
      friendlyFireDisabled: true,
      allowedClasses: ['Mago', 'Samurai', 'Padre', 'Cangaceiro', 'Assassino', 'Param√©dico'],
      minTeamSize: 2
    },
    minPlayers: 4,
    maxPlayers: 16,
  },
  {
    id: uuidv4(),
    name: 'Modo JoKenPo',
    description: 'Vers√£o silenciosa do jogo para ambientes com ru√≠do ou necessidade de sil√™ncio.',
    rules: {
      silentMode: true,
      gestureOnly: true,
      rhythmType: 'jokenpo',
      allowedClasses: ['Mago', 'Samurai', 'Padre', 'Cangaceiro']
    },
    minPlayers: 2,
    maxPlayers: 5,
  },
  {
    id: uuidv4(),
    name: 'Torneio',
    description: 'Formato competitivo com sistema de pontua√ß√£o e configura√ß√£o espec√≠fica de classes.',
    rules: {
      competitiveMode: true,
      scoringSystem: {
        kill: 1,
        win: 5,
        finalTwo: 3
      },
      classDistribution: {
        'Mago': 2,
        'Samurai': 2,
        'Padre': 1,
        'Cangaceiro': 2,
        'Assassino': 2
      }
    },
    minPlayers: 8,
    maxPlayers: 10,
  },
];

export async function seedDatabase() {
  try {
    console.log('üå± Starting database seeding...');

    // Clear existing data
    await db.delete(actions);
    await db.delete(classes);
    await db.delete(gameModes);
    
    console.log('üßπ Cleared existing data');

    // Seed classes
    await db.insert(classes).values(classesData);
    console.log(`‚úÖ Seeded ${classesData.length} classes`);

    // Seed actions
    await db.insert(actions).values(actionsData);
    console.log(`‚úÖ Seeded ${actionsData.length} actions`);

    // Seed game modes
    await db.insert(gameModes).values(gameModesData);
    console.log(`‚úÖ Seeded ${gameModesData.length} game modes`);

    console.log('üéâ Database seeding completed successfully!');
  } catch (error) {
    console.error('‚ùå Error seeding database:', error);
    throw error;
  }
}

export async function resetDatabase() {
  try {
    console.log('üîÑ Resetting database...');
    await seedDatabase();
    console.log('‚úÖ Database reset completed!');
  } catch (error) {
    console.error('‚ùå Error resetting database:', error);
    throw error;
  }
}